import{z as Te,p as Ue,b as Fe,Y as Ve,h as D,a1 as He,o as Oe,T as qe,i as L,d as o,e as Ie,F as Ke,E as We,V as Ye,K as w,U as Ge,s as g,g as e,l as a,c as r,j as ye,f as Q,m as p,$ as Je,r as t,W as Qe,R as ue,q as _e,v as X,w as u,D as Pe,x as me,H as ze,O as Xe}from"../chunks/euVeJPvK.js";import{a as pe,u as Ze}from"../chunks/BCUCx8Q8.js";import{C as je}from"../chunks/BCY0rcL3.js";import{B as we}from"../chunks/Be_B613E.js";import{L as Ne}from"../chunks/CtjSKAnx.js";function et(k){if(!k||k===""||k.trim()==="")return"N/A";try{const $=new Date(k);return isNaN($.getTime())?"N/A":$.toLocaleString()}catch($){return console.warn("Error formatting date:",$),"N/A"}}var tt=p('<meta name="description" content="Manage customers"/>'),at=p('<div class="mt-4 p-4 bg-red-50 border border-red-200 rounded-md"><p class="text-red-600"> </p> <!></div>'),rt=p('<!> <span class="ml-2">Refreshing...</span>',1),st=p('<div class="flex flex-col sm:flex-row gap-4 items-center justify-between"><div class="flex-1 max-w-md"><label for="search" class="sr-only">Search customers</label> <div class="relative"><input id="search" type="text" class="w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500" placeholder="Search customers by name or email..."/> <button class="absolute inset-y-0 right-0 px-3 flex items-center text-gray-400 hover:text-gray-600"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button></div></div> <div class="flex items-center gap-2"><!></div></div>'),it=p('<div class="flex justify-center items-center py-12"><!></div>'),ot=p('<div class="text-center py-12"><svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path></svg> <h3 class="mt-2 text-sm font-medium text-gray-900">No customers found</h3> <p class="mt-1 text-sm text-gray-500"> </p></div>'),dt=p('<div class="text-xs text-orange-500">Email hidden</div>'),lt=p('<tr class="hover:bg-gray-50"><td class="px-6 py-4 whitespace-nowrap"><div class="flex items-center"><div class="flex-shrink-0 h-10 w-10"><div class="h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center"><span class="text-sm font-medium text-blue-600"> </span></div></div> <div class="ml-4"><div class="text-sm font-medium text-gray-900"> </div> <div class="text-sm text-gray-500"> </div></div></div></td><td class="px-6 py-4 whitespace-nowrap"><div class="text-sm text-gray-900"> </div> <!></td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500"> </td><td class="px-6 py-4 whitespace-nowrap"><span> </span></td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500"> </td><td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium"><!></td></tr>'),nt=p("<button> </button>"),vt=p('<div class="bg-white px-4 py-3 border-t border-gray-200 sm:px-6"><div class="flex items-center justify-between"><div class="flex-1 flex justify-between sm:hidden"><button class="relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed">Previous</button> <button class="ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed">Next</button></div> <div class="hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"><div><p class="text-sm text-gray-700">Showing <span class="font-medium"> </span> to <span class="font-medium"> </span> of <span class="font-medium"> </span> results</p></div> <div><nav class="relative z-0 inline-flex rounded-md shadow-sm -space-x-px"><button class="relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"><svg class="h-5 w-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path></svg></button> <!> <button class="relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"><svg class="h-5 w-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></button></nav></div></div></div></div>'),ct=p('<div class="overflow-x-auto"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Customer</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Email</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Registration Date</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Orders</th><th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th></tr></thead><tbody class="bg-white divide-y divide-gray-200"></tbody></table></div> <!>',1),ut=p('<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"><div class="mb-8"><h1 class="text-3xl font-bold text-gray-900">Customers</h1> <p class="mt-2 text-gray-600">Manage your customer base</p> <!></div> <!> <!></div>');function ht(k,$){Ue($,!0);const ke=()=>Ke(Ze,"$userStore",Ae),[Ae,Ee]=We();Fe(()=>{(!ke()||!ke().isAdmin)&&Ve("/")});let Z=D(!0),R=D(He([])),ee=D(null),T=D(""),n=D(1),te=20,ae=D(0);Oe(()=>{U()});async function U(){try{g(Z,!0),g(ee,null);const i={};pe&&pe.authStore&&pe.authStore.token&&(i.Authorization=`Bearer ${pe.authStore.token}`);const h=new URLSearchParams({page:e(n).toString(),limit:te.toString(),...e(T)&&{search:e(T)}}),v=await fetch(`/api/admin/customers?${h}`,{headers:i});if(!v.ok)throw new Error("Failed to fetch customers");const f=await v.json();g(R,f.customers||[],!0),g(ae,f.total||0,!0)}catch(i){console.error("Error fetching customers:",i),g(ee,i instanceof Error?i.message:"Failed to fetch customers",!0),g(R,[],!0)}finally{g(Z,!1)}}function $e(){g(n,1),U()}const re=me(()=>Math.ceil(e(ae)/te)),Ce=me(()=>e(n)<e(re)),Se=me(()=>e(n)>1);function F(i){g(n,i,!0),U()}var xe=ut();qe("zvcdha",i=>{var h=tt();Ye(()=>{Je.title="Customers - Admin | FixTar"}),o(i,h)});var fe=a(xe),Be=r(a(fe),4);{var De=i=>{var h=at(),v=a(h),f=a(v);t(v);var C=r(v,2);we(C,{onclick:U,variant:"secondary",class:"mt-2",children:(_,se)=>{ue();var d=_e("Retry");o(_,d)},$$slots:{default:!0}}),t(h),X(()=>u(f,`Error: ${e(ee)??""}`)),o(i,h)};L(Be,i=>{e(ee)&&i(De)})}t(fe);var Me=r(fe,2);je(Me,{class:"mb-6",children:(i,h)=>{var v=st(),f=a(v),C=r(a(f),2),_=a(C);Qe(_);var se=r(_,2);t(C),t(f);var d=r(f,2),m=a(d);we(m,{onclick:U,variant:"secondary",children:(l,V)=>{var H=ye(),ge=Q(H);{var he=s=>{var x=rt(),y=Q(x);Ne(y,{visible:!0}),ue(2),o(s,x)},b=s=>{var x=_e("Refresh");o(s,x)};L(ge,s=>{e(Z)?s(he):s(b,!1)})}o(l,H)},$$slots:{default:!0}}),t(d),t(v),w("keydown",_,l=>l.key==="Enter"&&$e()),Ge(_,()=>e(T),l=>g(T,l)),w("click",se,$e),o(i,v)},$$slots:{default:!0}});var Le=r(Me,2);je(Le,{children:(i,h)=>{var v=ye(),f=Q(v);{var C=d=>{var m=it(),l=a(m);Ne(l,{visible:!0}),t(m),o(d,m)},_=d=>{var m=ot(),l=r(a(m),4),V=a(l,!0);t(l),t(m),X(()=>u(V,e(T)?"Try adjusting your search criteria.":"No customers have registered yet.")),o(d,m)},se=d=>{var m=ct(),l=Q(m),V=a(l),H=r(a(V));Pe(H,21,()=>e(R),b=>b.id,(b,s)=>{var x=lt(),y=a(x),S=a(y),M=a(S),O=a(M),P=a(O),ie=a(P,!0);t(P),t(O),t(M);var z=r(M,2),q=a(z),I=a(q,!0);t(q);var oe=r(q,2),de=a(oe);t(oe),t(z),t(S),t(y);var K=r(y),j=a(K),le=a(j,!0);t(j);var W=r(j,2);{var ne=c=>{var B=dt();o(c,B)};L(W,c=>{e(s).emailVisibility===!1&&c(ne)})}t(K);var N=r(K),Y=a(N,!0);t(N);var ve=r(N),G=a(ve),A=a(G,!0);t(G),t(ve);var E=r(ve),be=a(E);t(E);var ce=r(E),J=a(ce);we(J,{get href(){return`/admin/customers/${e(s).id??""}`},variant:"ghost",size:"sm",children:(c,B)=>{ue();var Re=_e("View Details");o(c,Re)},$$slots:{default:!0}}),t(ce),t(x),X((c,B)=>{u(ie,c),u(I,e(s).name||"No name provided"),u(de,`Customer ID: ${e(s).id??""}`),u(le,e(s).email),u(Y,B),ze(G,1,`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${e(s).verified?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`),u(A,e(s).verified?"Verified":"Unverified"),u(be,`${(e(s).orderCount||0)??""} orders`)},[()=>e(s).name?e(s).name.charAt(0).toUpperCase():e(s).email.charAt(0).toUpperCase(),()=>et(e(s).created)]),o(b,x)}),t(H),t(V),t(l);var ge=r(l,2);{var he=b=>{var s=vt(),x=a(s),y=a(x),S=a(y),M=r(S,2);t(y);var O=r(y,2),P=a(O),ie=a(P),z=r(a(ie)),q=a(z,!0);t(z);var I=r(z,2),oe=a(I,!0);t(I);var de=r(I,2),K=a(de,!0);t(de),ue(),t(ie),t(P);var j=r(P,2),le=a(j),W=a(le),ne=r(W,2);Pe(ne,17,()=>Array(Math.min(5,e(re))),Xe,(Y,ve,G)=>{const A=me(()=>G+Math.max(1,e(n)-2));var E=ye(),be=Q(E);{var ce=J=>{var c=nt(),B=a(c,!0);t(c),X(()=>{ze(c,1,`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${e(A)===e(n)?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`),u(B,e(A))}),w("click",c,()=>F(e(A))),o(J,c)};L(be,J=>{e(A)<=e(re)&&J(ce)})}o(Y,E)});var N=r(ne,2);t(le),t(j),t(O),t(x),t(s),X(Y=>{S.disabled=!e(Se),M.disabled=!e(Ce),u(q,(e(n)-1)*te+1),u(oe,Y),u(K,e(ae)),W.disabled=!e(Se),N.disabled=!e(Ce)},[()=>Math.min(e(n)*te,e(ae))]),w("click",S,()=>F(e(n)-1)),w("click",M,()=>F(e(n)+1)),w("click",W,()=>F(e(n)-1)),w("click",N,()=>F(e(n)+1)),o(b,s)};L(ge,b=>{e(re)>1&&b(he)})}o(d,m)};L(f,d=>{e(Z)&&e(R).length===0?d(C):e(R).length===0?d(_,1):d(se,!1)})}o(i,v)},$$slots:{default:!0}}),t(xe),o(k,xe),Ie(),Ee()}Te(["keydown","click"]);export{ht as component};
